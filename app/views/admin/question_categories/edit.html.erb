<% content_for :head do %>
  <%= javascript_include_tag 'admin/jquery.scrollTo-min' %>
  <%= stylesheet_link_tag 'admin/spree_faq' %>
<% end %>
<%= form_for @question_category, :url => object_path do |f| %>
  <%= render "shared/error_messages", :target => f.object %>
  <%= javascript_tag do %>
     var new_question_html = '<%= generate_template(f, :questions) %>';

     jQuery(document).ready(function($) {
        $('#new_question_link').click(function() {
          $('#questions').append(new_question_html.replace(/NEW_RECORD/g, $('#questions .question').size()));
          $('#questions .question:last .remove').click(function() {
            $(this).parent('.question').remove();
          });
          $.scrollTo(jQuery('#questions .question:last'), 800);
          $('.question:last input:first').focus();
        });
        $('#questions .remove').click(function() { 
          $(this).parent('.question').children(':hidden[id$=delete]').val(1);
          $(this).parent('.question').slideUp('slow');
        });
     });
  <% end %>
  <div class="yui-gc">
    <div class="yui-u first">

      <%= f.field_container :name do %>
          <%= f.label :name, t("category_name") %> <span class="required">*</span><br />
          <%= f.text_field :name, :class => 'fullwidth title'  %>  
          <%= f.error_message_on :name %>
      <% end %>

      <div id="questions">
        <h2>Questions</h2>
        <%= button_link_to t('add_question'), '#', {:icon => 'add', :id => 'new_question_link' } %>
        <div class="clear"></div>

        <%= f.fields_for :questions do |question_form| %>
          <%= render :partial => 'question', :locals => {:f => question_form } %>
        <% end %>
      </div>

      <%= render :partial => 'admin/shared/edit_resource_links' %>
    </div>
  </div>
                                      
<% end %>
